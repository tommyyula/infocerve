---
inclusion: manual
---

# 测试用例设计规范

---

## 测试金字塔

```
        /\
       /  \
      / E2E \        少量，验证核心流程
     /--------\
    /   API    \     中量，验证接口契约
   /--------------\
  /     Unit       \  大量，验证业务逻辑
 /------------------\
```

---

## 文件位置

```
.kiro/specs/{feature-name}/
  e2e-test-cases.md      # 端到端测试用例
  unit-test-cases.md     # 单元测试用例
  api-test-cases.md      # API 测试用例
```

---

## E2E 测试用例模板

```markdown
### E2E-001: {测试标题}

关联需求：需求 X.Y
关联故事：Story X
优先级：P0/P1/P2

前置条件：
- 条件1
- 条件2

测试步骤：
1. 步骤1
2. 步骤2

预期结果：
- 结果1
- 结果2

测试数据：
- 数据1
```

---

## 单元测试用例模板

```markdown
### UT-AGG-001: {聚合名} - {测试场景}

关联聚合：{聚合名}
关联方法：{方法名}
关联业务规则：BR-XXX-001
测试类型：聚合根测试

测试场景：
- 场景描述

前置状态：
- 聚合初始状态

输入：
- 方法参数

预期结果：
- 状态变化
- 事件发布
```

---

## API 测试用例模板

```markdown
### API-001: {API 名称} - {测试场景}

关联需求：需求 X.Y
API：{METHOD} {PATH}
测试类型：正常/异常/边界

请求：
{JSON 请求体}

预期响应：
- HTTP 状态码：200
- 响应体：{JSON 响应体}

验证点：
- 验证点1
```

---

## 测试用例编号规范

E2E 测试 - E2E-001
值对象测试 - UT-VO-001
聚合测试 - UT-AGG-001
领域服务测试 - UT-DS-001
应用服务测试 - UT-AS-001
API 测试 - API-001

---

## 优先级定义

P0 - 核心功能，必须通过，每次提交执行
P1 - 重要功能，应该通过，每次提交执行
P2 - 一般功能，建议通过，发布前执行
P3 - 边缘场景，可选，定期执行

---

## 检查清单

E2E 测试：
- [ ] 覆盖核心业务流程
- [ ] 包含多端协作场景
- [ ] 前置条件完整
- [ ] 测试数据明确

单元测试：
- [ ] 覆盖所有值对象
- [ ] 覆盖所有聚合方法
- [ ] 覆盖所有领域服务
- [ ] 包含正常和异常场景
- [ ] 关联业务规则

API 测试：
- [ ] 覆盖所有 API
- [ ] 包含正常、异常、边界场景
- [ ] 请求响应示例完整

