---
inclusion: manual
---

# 领域分析编写规范（Domain Analysis Guidelines）

## 概述

本规范定义了领域分析（战略设计）的编写标准。

---

## 文件位置

```
.kiro/specs/{feature-name}/domain-analysis.md
```

---

## 模板结构

```markdown
# {功能名称} - 领域分析

## 1. 统一语言（Ubiquitous Language）
## 2. 领域识别
## 3. 限界上下文（Bounded Context）
## 4. 业务流程
## 5. 业务规则
```

---

## 1. 统一语言

统一语言是团队共同使用的业务术语。

格式：
- 术语 - 中文业务名称
- 定义 - 清晰的业务含义
- 英文 - 代码中使用的名称（PascalCase）

示例：
- 入库单 - 记录物料入库的单据，包含供应商、入库明细等信息 - InboundOrder

---

## 2. 领域识别

### 核心域（Core Domain）
核心竞争力所在，需要重点投入自研。

### 支撑域（Supporting Domain）
支持核心域运作，但不是核心竞争力。

### 通用域（Generic Domain）
可以使用通用方案或外购。

### 判断标准

核心域：
- 是核心竞争力
- 需要高度定制
- 不能外购
- 投入优先级最高

支撑域：
- 不是核心竞争力
- 部分定制
- 可考虑外购
- 投入优先级中等

通用域：
- 不是核心竞争力
- 标准方案
- 推荐外购
- 投入优先级最低

---

## 3. 限界上下文

### 上下文划分

描述每个上下文的职责和核心概念：
- 上下文名称
- 职责
- 核心概念
- 所属领域

### 上下文映射

使用 ASCII 图描述上下文之间的关系。

### 上下文关系类型

- Partnership - 两个上下文紧密合作，共同演进
- Shared Kernel (SK) - 共享部分模型代码
- Customer-Supplier (U/D) - 下游依赖上游
- Conformist - 下游完全遵从上游模型
- Anti-Corruption Layer (ACL) - 隔离外部系统
- Open Host Service (OHS) - 提供标准化 API
- Published Language (PL) - 定义标准数据交换格式

---

## 4. 业务流程

### 端到端业务流程

描述完整的业务流程，包括多个阶段、多个角色、多个系统的协作。

### 多端协作模型

描述不同终端、不同角色在业务流程中的职责分工：
- PC/Web - 仓库管理员 - 创建单据、确认、分配任务
- 手持端/PDA - 操作员 - 查看任务、扫描、采集数据
- 系统 - 自动 - 生成任务、汇总数据、更新库存

### 任务驱动模型

对于需要现场执行的业务，描述任务的生成、分配、执行、完成流程。

### 事件风暴格式

使用命令 - 事件 - 策略的格式描述业务流程的核心交互。

---

## 5. 业务规则

### 编写格式

使用编号标识业务规则：

```
BR-{上下文缩写}-{序号}

示例：
BR-IN-001   入库上下文第1条规则
BR-OUT-001  出库上下文第1条规则
BR-INV-001  库存上下文第1条规则
```

每条规则包含：
- 编号
- 规则描述
- 触发场景

---

## 检查清单

统一语言：
- [ ] 所有业务术语都有明确定义
- [ ] 英文命名符合 PascalCase 规范
- [ ] 术语与用户故事中使用的一致

领域识别：
- [ ] 明确区分核心域、支撑域、通用域
- [ ] 每个领域有明确的投入策略

限界上下文：
- [ ] 每个上下文职责清晰、边界明确
- [ ] 上下文之间的关系类型正确
- [ ] 上下文映射图清晰

业务流程：
- [ ] 端到端业务流程完整描述
- [ ] 多端协作模型清晰
- [ ] 任务驱动模型明确（如有）
- [ ] 命令、事件、策略对应清晰

业务规则：
- [ ] 所有业务规则有唯一编号
- [ ] 规则描述清晰、可测试
- [ ] 触发场景明确

---

## 常见问题

Q: 如何判断两个概念是否属于同一个上下文？
A: 如果两个概念在业务上紧密相关，且通常一起变化，则属于同一上下文。

Q: 上下文之间如何通信？
A: 通过领域事件异步通信，或通过 API 同步调用。避免直接引用其他上下文的领域对象。

Q: 业务规则应该写多详细？
A: 写到可以直接转化为验收标准和测试用例的程度。

---

## 下一步

完成 domain-analysis.md 后，进入需求规格阶段，编写 requirements.md。

---

最后更新：2026-01-03
