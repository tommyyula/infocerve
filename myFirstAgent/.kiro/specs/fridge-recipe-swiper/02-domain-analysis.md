# 阶段 2: 领域分析 (Domain Analysis)

## 核心业务领域

本项目属于 **智能烹饪助手** 领域，结合：
- 计算机视觉（图像识别）
- 自然语言处理（食谱生成）
- 用户交互设计（滑动选择）

---

## 业务流程

### 主流程图

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  上传照片   │───▶│  AI 识别    │───▶│  生成食谱   │───▶│  滑动选择   │
│             │    │  食材       │    │  推荐       │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                          │                  │                  │
                          ▼                  ▼                  ▼
                   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
                   │  用户确认/  │    │  食谱卡片   │    │  查看详情   │
                   │  修正食材   │    │  列表       │    │  /收藏      │
                   └─────────────┘    └─────────────┘    └─────────────┘
```

### 详细流程步骤

| 步骤 | 用户行为 | 系统响应 |
|------|----------|----------|
| 1 | 打开应用 | 显示上传界面 |
| 2 | 拍照/选择照片 | 上传图片到服务器 |
| 3 | 等待 | AI 分析图片，识别食材 |
| 4 | 查看识别结果 | 显示食材列表，允许编辑 |
| 5 | 确认食材 | 调用 AI 生成食谱 |
| 6 | 滑动浏览食谱 | 左滑跳过，右滑收藏 |
| 7 | 点击卡片 | 显示食谱详情 |
| 8 | 开始烹饪 | （可选）步骤导航模式 |

---

## 限界上下文 (Bounded Contexts)

### 1. 图像处理上下文 (Image Processing Context)
**职责**: 处理用户上传的图片
- 图片上传
- 图片压缩/优化
- 图片存储（临时）

### 2. 食材识别上下文 (Ingredient Recognition Context)
**职责**: AI 识别图片中的食材
- 调用 Gemini Vision API
- 解析识别结果
- 食材标准化（统一命名）

### 3. 食谱生成上下文 (Recipe Generation Context)
**职责**: 基于食材生成食谱推荐
- 调用 Gemini API 生成食谱
- 食谱结构化处理
- 食谱评分/排序

### 4. 用户交互上下文 (User Interaction Context)
**职责**: 处理用户的滑动和选择
- 滑动手势处理
- 收藏管理
- 历史记录

### 5. 数据持久化上下文 (Persistence Context)
**职责**: 保存用户数据
- 收藏的食谱
- 浏览历史
- 用户偏好（未来）

---

## 统一语言 (Ubiquitous Language)

| 术语 | 英文 | 定义 |
|------|------|------|
| 食材 | Ingredient | 可用于烹饪的原材料，如蔬菜、肉类、调味料 |
| 食材照片 | Ingredient Photo | 用户上传的冰箱/食材图片 |
| 食材识别 | Ingredient Recognition | AI 分析图片并提取食材列表的过程 |
| 食谱 | Recipe | 包含名称、食材、步骤的烹饪指南 |
| 食谱卡片 | Recipe Card | 展示食谱摘要的 UI 组件 |
| 左滑 | Swipe Left | 跳过/不喜欢当前食谱 |
| 右滑 | Swipe Right | 喜欢/收藏当前食谱 |
| 收藏 | Favorite | 用户喜欢并保存的食谱 |
| 烹饪时间 | Cooking Time | 完成一道菜所需的预计时间 |
| 难度等级 | Difficulty Level | 食谱的烹饪难度（简单/中等/困难） |

---

## 核心领域事件 (Domain Events)

| 事件 | 触发条件 | 后续动作 |
|------|----------|----------|
| PhotoUploaded | 用户上传照片 | 开始识别食材 |
| IngredientsRecognized | AI 完成识别 | 显示食材列表 |
| IngredientsConfirmed | 用户确认食材 | 开始生成食谱 |
| RecipesGenerated | AI 生成食谱完成 | 显示食谱卡片 |
| RecipeSwiped | 用户滑动卡片 | 记录偏好，显示下一张 |
| RecipeFavorited | 用户右滑收藏 | 保存到收藏列表 |
| RecipeViewed | 用户点击查看详情 | 显示完整食谱 |

---

## 外部依赖

| 依赖 | 类型 | 用途 |
|------|------|------|
| Google Gemini API | AI 服务 | 图像识别 + 食谱生成 |
| Vercel | 部署平台 | 托管前端和 API |
| 数据库（待定） | 数据存储 | 保存用户收藏和历史 |

### 数据库选型

**选定方案**: ✅ **Vercel KV (Redis)**

| 特性 | 说明 |
|------|------|
| 类型 | Key-Value 存储 |
| 优点 | 与 Vercel 无缝集成，简单快速 |
| 用途 | 存储用户收藏、浏览历史 |

---

## 自检清单

- [x] 业务流程已梳理清楚
- [x] 限界上下文已划分
- [x] 统一语言已定义
- [x] 领域事件已识别
- [x] 外部依赖已列出

---

**文档状态**: ✅ 已确认数据库选型，待用户最终确认
**创建时间**: 2026-01-19
**版本**: 1.0
