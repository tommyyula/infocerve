<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MDM 客户与组织 Demo</title>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<style>
:root, [data-theme="light"] {
  --primary-color: #2f6fed;
  --primary-hover: #2558c4;
  --primary-light: #e8f0ff;
  --success-color: #2d9f5d;
  --success-bg: #e7f7ef;
  --warning-color: #b86f00;
  --warning-bg: #fff4df;
  --error-color: #c43b3b;
  --error-bg: #fdecec;
  --bg-primary: #ffffff;
  --bg-secondary: #f4f6fb;
  --bg-tertiary: #eef1f7;
  --text-primary: #1b1f2a;
  --text-secondary: #586174;
  --text-inverse: #ffffff;
  --border-color: #e1e6f0;
  --sidebar-bg: linear-gradient(180deg, #2f6fed 0%, #1f4fb2 100%);
  --sidebar-text: #ffffff;
  --sidebar-hover: rgba(255, 255, 255, 0.12);
  --sidebar-active: rgba(255, 255, 255, 0.22);
  --card-bg: #ffffff;
  --card-shadow: 0 1px 3px rgba(24, 39, 75, 0.12);
  --header-bg: #ffffff;
  --header-border: #e1e6f0;
}
[data-theme="dark"] {
  --primary-color: #6a8cff;
  --primary-hover: #5572d9;
  --primary-light: #1e2a4a;
  --success-color: #6fd08c;
  --success-bg: #13261c;
  --warning-color: #f4b25e;
  --warning-bg: #2c1f0f;
  --error-color: #ff9a9a;
  --error-bg: #2a1212;
  --bg-primary: #16181d;
  --bg-secondary: #111318;
  --bg-tertiary: #0c0e12;
  --text-primary: #f5f7fb;
  --text-secondary: #b3bbcc;
  --text-inverse: #111318;
  --border-color: #2b2f39;
  --sidebar-bg: linear-gradient(180deg, #1c2742 0%, #141b2d 100%);
  --sidebar-text: #f5f7fb;
  --sidebar-hover: rgba(255, 255, 255, 0.08);
  --sidebar-active: rgba(255, 255, 255, 0.16);
  --card-bg: #1e222b;
  --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.45);
  --header-bg: #16181d;
  --header-border: #2b2f39;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: "Avenir Next", "Trebuchet MS", "Segoe UI", sans-serif;
  color: var(--text-primary);
  background: var(--bg-secondary);
}
.app {
  display: grid;
  grid-template-columns: 220px 1fr;
  min-height: 100vh;
}
.sidebar {
  background: var(--sidebar-bg);
  color: var(--sidebar-text);
  padding: 20px 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.brand {
  font-size: 18px;
  font-weight: 700;
  letter-spacing: 1px;
}
.nav {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.nav button {
  border: none;
  background: transparent;
  color: var(--sidebar-text);
  text-align: left;
  padding: 10px 12px;
  border-radius: 8px;
  cursor: pointer;
}
.nav button.active {
  background: var(--sidebar-active);
}
.nav button:hover {
  background: var(--sidebar-hover);
}
.main {
  display: flex;
  flex-direction: column;
}
.header {
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  background: var(--header-bg);
  border-bottom: 1px solid var(--header-border);
}
.header .actions {
  display: flex;
  gap: 12px;
  align-items: center;
}
.theme-toggle {
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}
.content {
  padding: 20px;
  display: grid;
  gap: 16px;
}
.card {
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 16px;
  box-shadow: var(--card-shadow);
}
.card h3 {
  margin: 0 0 12px 0;
  font-size: 16px;
}
.filters {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}
.filters input, .filters select {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
}
.table {
  width: 100%;
  border-collapse: collapse;
}
.table th, .table td {
  padding: 10px;
  border-bottom: 1px solid var(--border-color);
  text-align: left;
}
.tag {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 12px;
}
.tag-success { background: var(--success-bg); color: var(--success-color); }
.tag-warning { background: var(--warning-bg); color: var(--warning-color); }
.tag-error { background: var(--error-bg); color: var(--error-color); }
.tag-default { background: var(--bg-tertiary); color: var(--text-secondary); }
.form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}
.form-grid input, .form-grid select, .form-grid textarea {
  width: 100%;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
}
.form-grid textarea { grid-column: span 2; }
.field label {
  display: block;
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 6px;
}
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}
.modal-card {
  width: 520px;
  max-width: 90vw;
  background: var(--card-bg);
  border-radius: 12px;
  border: 1px solid var(--border-color);
  padding: 16px;
  box-shadow: var(--card-shadow);
}
.modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 12px;
}
.btn {
  padding: 6px 14px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  cursor: pointer;
}
.btn-primary {
  background: var(--primary-color);
  color: var(--text-inverse);
  border-color: var(--primary-color);
}
.section-row {
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
}
.tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}
.tabs button {
  border: 1px solid var(--border-color);
  background: var(--bg-primary);
  color: var(--text-primary);
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
}
.tabs button.active {
  background: var(--primary-light);
  border-color: var(--primary-color);
}
@media (max-width: 1100px) {
  .app { grid-template-columns: 1fr; }
  .sidebar { flex-direction: row; flex-wrap: wrap; }
  .filters { grid-template-columns: 1fr; }
  .form-grid { grid-template-columns: 1fr; }
  .form-grid textarea { grid-column: span 1; }
}
</style>
</head>
<body>
<div id="app" class="app">
  <aside class="sidebar">
    <div class="brand">MDM 主数据</div>
    <div class="nav">
      <button :class="{active: page==='org-list'}" @click="page='org-list'">组织列表</button>
      <button :class="{active: page==='customer-list'}" @click="page='customer-list'">客户列表</button>
    </div>
  </aside>

  <div class="main">
    <header class="header">
      <div>{{ pageTitle }}</div>
      <div class="actions">
        <span>Tenant: FT</span>
        <button class="theme-toggle" @click="toggleTheme">{{ themeLabel }}</button>
        <span>管理员</span>
      </div>
    </header>

    <main class="content">
      <div v-if="page==='org-list'" class="card">
        <div class="section-row">
          <h3>组织列表</h3>
          <button class="btn btn-primary" @click="openOrgDetail('create')">新建组织</button>
        </div>
        <div class="filters" style="margin-top:12px;">
          <input placeholder="组织编码或名称" />
          <select>
            <option>标签: 全部</option>
            <option>CUSTOMER</option>
            <option>RETAILER</option>
            <option>BRAND</option>
          </select>
          <select>
            <option>状态: 全部</option>
            <option>ACTIVE</option>
            <option>INACTIVE</option>
          </select>
        </div>
        <table class="table" style="margin-top:12px;">
          <thead>
            <tr>
              <th>组织编码</th>
              <th>组织名称</th>
              <th>标签</th>
              <th>状态</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="org in orgs" :key="org.id">
              <td>{{ org.code }}</td>
              <td>{{ org.name }}</td>
              <td>
                <span class="tag tag-default" v-for="tag in org.tags" :key="tag" style="margin-right:4px;">{{ tag }}</span>
              </td>
              <td>
                <span :class="['tag', org.status==='ACTIVE' ? 'tag-success' : 'tag-warning']">{{ org.status }}</span>
              </td>
              <td>
                <button class="btn" @click="openOrgDetail('view')">查看</button>
                <button class="btn" style="margin-left:6px;" @click="openOrgDetail('edit')">编辑</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div v-if="page==='org-detail'" class="card">
        <div class="section-row">
          <h3>组织{{ orgModeLabel }}</h3>
          <div>
            <button class="btn" @click="page='org-list'">返回列表</button>
            <button class="btn btn-primary" style="margin-left:8px;">保存</button>
          </div>
        </div>
        <div class="tabs" style="margin-top:12px;">
          <button :class="{active: activeOrgTab==='basic'}" @click="activeOrgTab='basic'">基础信息</button>
          <button :class="{active: activeOrgTab==='contact'}" @click="activeOrgTab='contact'">联系人信息</button>
        </div>
        <div v-if="activeOrgTab==='basic'" class="form-grid">
          <div class="field">
            <label>组织编码</label>
            <input value="ORG-1001" placeholder="组织编码" />
          </div>
          <div class="field">
            <label>组织名称</label>
            <input value="北区零售集团" placeholder="组织名称" />
          </div>
          <div class="field">
            <label>组织全称</label>
            <input value="北区零售集团有限公司" placeholder="组织全称" />
          </div>
          <div class="field">
            <label>状态</label>
            <select>
              <option>ACTIVE</option>
              <option>INACTIVE</option>
            </select>
          </div>
          <div class="field">
            <label>标签</label>
            <input value="RETAILER, CUSTOMER" placeholder="标签(多选)" />
          </div>
          <div class="field">
            <label>是否有效</label>
            <input value="有效" placeholder="是否有效" />
          </div>
          <div class="field" style="grid-column: span 2;">
            <label>备注</label>
            <textarea rows="3" placeholder="备注">重点合作方，按季度复盘</textarea>
          </div>
        </div>
        <div v-if="activeOrgTab==='contact'" class="form-grid">
          <div class="field">
            <label>联系人姓名</label>
            <input value="李四" placeholder="联系人姓名" />
          </div>
          <div class="field">
            <label>联系人电话</label>
            <input value="13900000000" placeholder="联系人电话" />
          </div>
          <div class="field">
            <label>联系人邮箱</label>
            <input value="lisi@example.com" placeholder="联系人邮箱" />
          </div>
          <div class="field">
            <label>联系人类型</label>
            <input value="PRIMARY" placeholder="联系人类型" />
          </div>
          <div class="field" style="grid-column: span 2;">
            <label>联系人备注</label>
            <textarea rows="3" placeholder="联系人备注">重点合作方对接人</textarea>
          </div>
        </div>
      </div>

      <div v-if="page==='customer-list'" class="card">
        <div class="section-row">
          <h3>客户列表</h3>
          <button class="btn btn-primary" @click="openCustomerDetail('create')">新建客户</button>
        </div>
        <div class="filters" style="margin-top:12px;">
          <input placeholder="客户编码或名称" />
          <select>
            <option>状态: 全部</option>
            <option>ACTIVE</option>
            <option>INACTIVE</option>
          </select>
          <input placeholder="行业" />
        </div>
        <table class="table" style="margin-top:12px;">
          <thead>
            <tr>
              <th>客户编码</th>
              <th>客户名称</th>
              <th>组织ID</th>
              <th>状态</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="cust in customers" :key="cust.id">
              <td>{{ cust.customerCode }}</td>
              <td>{{ cust.name }}</td>
              <td>{{ cust.orgId }}</td>
              <td>
                <span :class="['tag', cust.status==='ACTIVE' ? 'tag-success' : 'tag-warning']">{{ cust.status }}</span>
              </td>
              <td>
                <button class="btn" @click="openCustomerDetail('view')">查看</button>
                <button class="btn" style="margin-left:6px;" @click="openCustomerDetail('edit')">编辑</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div v-if="page==='customer-detail'" class="card">
        <div class="section-row">
          <h3>客户{{ customerModeLabel }}</h3>
          <div>
            <button class="btn" @click="page='customer-list'">返回列表</button>
            <button class="btn btn-primary" style="margin-left:8px;">保存</button>
          </div>
        </div>

        <div class="tabs" style="margin-top:12px;">
          <button :class="{active: activeCustomerTab==='basic'}" @click="activeCustomerTab='basic'">基础信息</button>
          <button :class="{active: activeCustomerTab==='brand'}" @click="activeCustomerTab='brand'">客户-品牌商</button>
          <button :class="{active: activeCustomerTab==='retail'}" @click="activeCustomerTab='retail'">客户-零售商</button>
          <button :class="{active: activeCustomerTab==='supplier'}" @click="activeCustomerTab='supplier'">客户-供应商</button>
          <button :class="{active: activeCustomerTab==='department'}" @click="activeCustomerTab='department'">客户-部门</button>
          <button :class="{active: activeCustomerTab==='title'}" @click="activeCustomerTab='title'">客户-头衔</button>
        </div>

        <div v-if="activeCustomerTab==='basic'" class="form-grid">
          <div class="field">
            <label>客户编码</label>
            <input value="CUST-2001" placeholder="客户编码" />
          </div>
          <div class="field">
            <label>客户名称</label>
            <input value="华东电商客户" placeholder="客户名称" />
          </div>
          <div class="field">
            <label>客户全称</label>
            <input value="华东电商客户有限公司" placeholder="客户全称" />
          </div>
          <div class="field">
            <label>组织ID</label>
            <input value="ORG-1001" placeholder="组织ID" />
          </div>
          <div class="field">
            <label>状态</label>
            <select>
              <option>ACTIVE</option>
              <option>INACTIVE</option>
            </select>
          </div>
          <div class="field">
            <label>是否有效</label>
            <input value="有效" placeholder="是否有效" />
          </div>
          <div class="field">
            <label>行业</label>
            <input value="电商" placeholder="行业" />
          </div>
          <div class="field" style="grid-column: span 2;">
            <label>联系人信息</label>
            <textarea rows="3" placeholder="联系人信息">张三 / 13800000000 / zhangsan@example.com</textarea>
          </div>
        </div>

        <div v-if="activeCustomerTab!=='basic'">
          <div class="section-row" style="margin:12px 0;">
            <div>关系列表</div>
            <button class="btn btn-primary" @click="openRelationModal">新增关系</button>
          </div>
          <table class="table">
            <thead>
              <tr>
                <th>客户ID</th>
                <th>目标组织</th>
                <th>关系类型</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="rel in currentCustomerRelations" :key="rel.id">
                <td>{{ rel.customerId }}</td>
                <td>{{ rel.orgName }}</td>
                <td>{{ rel.tag }}</td>
                <td><button class="btn">删除</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div v-if="relationModalVisible" class="modal-backdrop">
        <div class="modal-card">
          <h3>新增客户关系</h3>
          <div class="form-grid" style="margin-top:12px;">
            <div class="field" style="grid-column: span 2;">
              <label>选择组织</label>
              <select v-model="relationTargetOrgId">
                <option value="">请选择组织</option>
                <option v-for="org in relationOrgOptions" :key="org.id" :value="org.id">{{ org.name }}</option>
              </select>
            </div>
          </div>
          <div class="modal-actions">
            <button class="btn" @click="closeRelationModal">取消</button>
            <button class="btn btn-primary" @click="saveRelation">保存</button>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<script>
const { createApp } = Vue;

const storedTheme = localStorage.getItem('theme') || 'light';
document.documentElement.setAttribute('data-theme', storedTheme);

createApp({
  data() {
    return {
      page: 'org-list',
      theme: storedTheme,
      orgMode: 'view',
      activeOrgTab: 'basic',
      customerMode: 'view',
      activeCustomerTab: 'basic',
      relationModalVisible: false,
      relationModalTag: '',
      relationTargetOrgId: '',
      orgs: [
        { id: 'ORG-1001', code: 'ORG-1001', name: '北区零售集团', tags: ['RETAILER'], status: 'ACTIVE' },
        { id: 'ORG-1002', code: 'ORG-1002', name: '华南品牌公司', tags: ['BRAND'], status: 'INACTIVE' }
      ],
      customers: [
        { id: 'CUST-2001', customerCode: 'CUST-2001', name: '华东电商客户', orgId: 'ORG-1001', status: 'ACTIVE' },
        { id: 'CUST-2002', customerCode: 'CUST-2002', name: '华北连锁客户', orgId: 'ORG-1003', status: 'INACTIVE' }
      ],
      relationsByTab: {
        brand: [
          { id: 'REL-B1', customerId: 'CUST-2001', orgName: '华南品牌公司', tag: 'BRAND' }
        ],
        retail: [
          { id: 'REL-R1', customerId: 'CUST-2001', orgName: '北区零售集团', tag: 'RETAILER' }
        ],
        supplier: [
          { id: 'REL-S1', customerId: 'CUST-2001', orgName: '华中供应商', tag: 'SUPPLIER' }
        ],
        department: [
          { id: 'REL-D1', customerId: 'CUST-2001', orgName: '零售事业部', tag: 'DEPARTMENT' }
        ],
        title: [
          { id: 'REL-T1', customerId: 'CUST-2001', orgName: '渠道经理', tag: 'TITLE' }
        ]
      }
    };
  },
  computed: {
    pageTitle() {
      const map = {
        'org-list': '组织列表',
        'org-detail': '组织详情',
        'customer-list': '客户列表',
        'customer-detail': '客户详情'
      };
      return map[this.page];
    },
    themeLabel() {
      return this.theme === 'light' ? 'Dark' : 'Light';
    },
    orgModeLabel() {
      const map = { create: '新建', edit: '编辑', view: '查看' };
      return map[this.orgMode];
    },
    customerModeLabel() {
      const map = { create: '新建', edit: '编辑', view: '查看' };
      return map[this.customerMode];
    },
    currentCustomerRelations() {
      return this.relationsByTab[this.activeCustomerTab] || [];
    },
    relationOrgOptions() {
      const tagMap = {
        brand: 'BRAND',
        retail: 'RETAILER',
        supplier: 'SUPPLIER',
        department: 'DEPARTMENT',
        title: 'TITLE'
      };
      const tag = tagMap[this.activeCustomerTab];
      if (!tag) {
        return [];
      }
      return this.orgs.filter((org) => org.tags.includes(tag));
    }
  },
  methods: {
    toggleTheme() {
      this.theme = this.theme === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', this.theme);
      localStorage.setItem('theme', this.theme);
    },
    openOrgDetail(mode) {
      this.orgMode = mode;
      this.page = 'org-detail';
      this.activeOrgTab = 'basic';
    },
    openCustomerDetail(mode) {
      this.customerMode = mode;
      this.page = 'customer-detail';
      this.activeCustomerTab = 'basic';
    },
    openRelationModal() {
      const tagMap = {
        brand: 'BRAND',
        retail: 'RETAILER',
        supplier: 'SUPPLIER',
        department: 'DEPARTMENT',
        title: 'TITLE'
      };
      this.relationModalTag = tagMap[this.activeCustomerTab] || '';
      this.relationTargetOrgId = '';
      this.relationModalVisible = true;
    },
    closeRelationModal() {
      this.relationModalVisible = false;
    },
    saveRelation() {
      if (!this.relationTargetOrgId || !this.relationModalTag) {
        this.relationModalVisible = false;
        return;
      }
      const selectedOrg = this.orgs.find((org) => org.id === this.relationTargetOrgId);
      const newRelation = {
        id: `REL-${Date.now()}`,
        customerId: 'CUST-2001',
        orgName: selectedOrg?.name || this.relationTargetOrgId,
        tag: this.relationModalTag
      };
      if (!this.relationsByTab[this.activeCustomerTab]) {
        this.relationsByTab[this.activeCustomerTab] = [];
      }
      this.relationsByTab[this.activeCustomerTab].push(newRelation);
      this.relationModalVisible = false;
    }
  }
}).mount('#app');
</script>
</body>
</html>
